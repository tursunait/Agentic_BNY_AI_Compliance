{
  "report_type": "SAR",
  "version": "3.0",
  "effective_date": "2026-02-21",
  "form_number": "FinCEN Form 111",
  "template_file": "knowledge_base/documents/pdf_templates/sar_report.pdf",
  "description": "Normalized case-input schema used by SAR/CTR filing logic. Supports top-level array payloads.",
  "input_payload_schema": {
    "type": "array",
    "minItems": 1,
    "items": {
      "$ref": "#/definitions/case"
    }
  },
  "definitions": {
    "bool_like": {
      "oneOf": [
        {
          "type": "boolean"
        },
        {
          "type": "string",
          "enum": [
            "True",
            "False",
            "true",
            "false"
          ]
        }
      ]
    },
    "amount_block": {
      "type": "object",
      "properties": {
        "amount_usd": {
          "type": [
            "number",
            "string"
          ]
        },
        "no_amount": {
          "$ref": "#/definitions/bool_like"
        }
      }
    },
    "date_range_block": {
      "type": "object",
      "properties": {
        "from": {
          "type": "string"
        },
        "to": {
          "type": "string"
        }
      }
    },
    "subject": {
      "type": "object",
      "properties": {
        "subject_id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "risk_rating": {
          "type": "string"
        },
        "country": {
          "type": "string"
        },
        "onboarding_date": {
          "type": "string"
        },
        "industry_or_occupation": {
          "type": "string"
        },
        "beneficial_owners": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "prior_sars": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "institution": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "branch_city": {
          "type": "string"
        },
        "branch_state": {
          "type": "string"
        },
        "contact_officer": {
          "type": "string"
        },
        "contact_phone": {
          "type": "string"
        },
        "primary_federal_regulator": {
          "type": "string"
        },
        "ein": {
          "type": "string"
        },
        "address": {
          "type": "string"
        }
      }
    },
    "alert": {
      "type": "object",
      "properties": {
        "alert_id": {
          "type": "string"
        },
        "alert_date": {
          "type": "string"
        },
        "model_name": {
          "type": "string"
        },
        "trigger_reasons": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "risk_score": {
          "type": [
            "number",
            "string"
          ]
        },
        "red_flags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "external_signals": {
      "type": "object",
      "properties": {
        "adverse_media": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "law_enforcement_contacted": {
          "type": "object",
          "properties": {
            "contacted": {
              "$ref": "#/definitions/bool_like"
            },
            "agency": {
              "type": "string"
            },
            "contact_name": {
              "type": "string"
            },
            "phone": {
              "type": "string"
            },
            "date": {
              "type": "string"
            }
          }
        }
      }
    },
    "data_quality": {
      "type": "object",
      "properties": {
        "missing_subject_tin": {
          "$ref": "#/definitions/bool_like"
        },
        "missing_counterparty": {
          "$ref": "#/definitions/bool_like"
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "suspicious_activity_information": {
      "type": "object",
      "properties": {
        "26_AmountInvolved": {
          "$ref": "#/definitions/amount_block"
        },
        "27_DateOrDateRange": {
          "$ref": "#/definitions/date_range_block"
        },
        "28_CumulativeAmount": {
          "type": [
            "number",
            "string",
            "null"
          ]
        },
        "29_Structuring": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "30_TerroristFinancing": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "31_Fraud": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "32_Casinos": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "33_MoneyLaundering": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "34_IdentificationDocumentation": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "35_OtherSuspiciousActivities": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "36_Insurance": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "37_SecuritiesFuturesOptions": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "38_MortgageFraud": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "39_ProductTypesInvolved": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "40_InstrumentTypesInvolved": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "transaction": {
      "type": "object",
      "properties": {
        "tx_id": {
          "type": "string"
        },
        "timestamp": {
          "type": "string"
        },
        "amount_usd": {
          "type": [
            "number",
            "string"
          ]
        },
        "origin_account": {
          "type": "string"
        },
        "destination_account": {
          "type": "string"
        },
        "location": {
          "type": "string"
        },
        "product_type": {
          "type": "string"
        },
        "instrument_type": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "case": {
      "type": "object",
      "required": [
        "case_id",
        "subject",
        "institution",
        "SuspiciousActivityInformation",
        "transactions"
      ],
      "properties": {
        "case_id": {
          "type": "string"
        },
        "report_type": {
          "type": "string"
        },
        "generated_at": {
          "type": "string"
        },
        "subject": {
          "$ref": "#/definitions/subject"
        },
        "institution": {
          "$ref": "#/definitions/institution"
        },
        "alert": {
          "$ref": "#/definitions/alert"
        },
        "external_signals": {
          "$ref": "#/definitions/external_signals"
        },
        "data_quality": {
          "$ref": "#/definitions/data_quality"
        },
        "SuspiciousActivityInformation": {
          "$ref": "#/definitions/suspicious_activity_information"
        },
        "transactions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/transaction"
          }
        },
        "narrative": {
          "type": "string"
        }
      }
    }
  }
}
